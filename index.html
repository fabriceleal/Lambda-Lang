<html>
<head>
<script src="jquery-1.7.min.js"></script>
<script src="get_data.js"></script>
<script>

var LAMBDA = {};

getData('parser.js', function(compiled){
	LAMBDA.parse = compiled;
});

var tests = [];

</script>
<script src="interpreter.js"></script>
</head>
<body>
<script>
var Logger = {};
Logger.write = (function(){
	var execs = 0;
	return function(msg){
		execs++;
		$('#result').append('[#'+execs+']' + msg);
		$('#result').append('<br/ >');
	};
})();

Logger.reset = function(){
	$('#result').empty();
};

$(function(){
	getData('tests.index.json', 
			function(compiled){
					compiled.forEach(function(item, idx){
						var a = document.createElement('a');

						getData(item, function(newTest){								
								a.href = '#';
								tests[idx] = newTest.code;
								a.onclick = function(){
									$('#code').val(tests[idx]);
								};
								a.innerHTML = newTest.description;								
						});

						$('#tests')[0].appendChild(a);
						$('#tests')[0].appendChild(document.createElement('br'));

					});
			});
	//---

	$('#run').click(function(){
		
		try{
			var parsed = LAMBDA.parse($('#code').val());
			Logger.write('Parsed: ' + JSON.stringify(parsed));
			try{
				var res = evalExpr(parsed, undefined);
				Logger.write('Result: ' + exprToString(res)
						//(typeof res === 'function' ? res.toString() : JSON.stringify(res))
				);
			}catch(e){
				Logger.write('Error on eval: ' + e);
			}
		}catch(e){
			Logger.write('Error on parse: ' + e);
		}
	});
	
	$('#clean').click(Logger.reset);

});
</script>
<div style="float: left;">
<h1>Fabrice Leal's Lambda-Lang</h1>
Sorry for the broken html!<br/>
This is a <a href="https://github.com/fabriceleal/Lambda-Lang">personal project</a> hosted at github.
The foundations for this language are in <a href="http://www.utdallas.edu/~gupta/courses/apl/lambda.pdf">this paper</a><br/ >
Syntax:<br/ >
Function: '#'Argument'.'Expression<br/ >
Expression: Var-Name / Function / Application<br/ >
Application: '('Function Parameter')'<br/ >
Var-Name: a single char<br/ >
	<textarea id="code" style="height: 300px; width: 400px;"></textarea>
	<input id="run" type="submit" value="Run!" />
</div>
<div style="float: right;">
	<div>
	Try it!:
		<div id="tests"></div>
	Log:
		<div><div id="result"></div><a id="clean" href="#">Clean Logs!</a></div>
	</div>
</div>
</body>
</html>
